<!DOCTYPE html>
<html lang="cs">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Handling bundles in activities and fragments &ndash; Jestřáblog</title>

    <!-- Meta -->
    <meta name="description" content="Jestřáblog &ndash; Život z ptačí perspektivy">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Social -->
    <meta property="article:author" content="Petr Nohejl" />
    <meta property="article:section" content="Android" />
    <meta property="article:published_time" content="2014-03-30" />

    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Handling bundles in activities and fragments"/>
    <meta property="og:description" content="Bundle is a useful data holder, which maps String values to various Parcelable types. So basically it is a heterogenous key/value map. Bundles are used in Intents, Activities and Fragments for transporting data. I would like to describe how I work with Bundles on Android and show you some …"/>
    <meta property="og:site_name" content="Jestřáblog" />
    <meta property="og:url" content="http://blog.petrnohejl.cz/handling-bundles-in-activities-and-fragments"/>

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Handling bundles in activities and fragments">
    <meta name="twitter:description" content="Bundle is a useful data holder, which maps String values to various Parcelable types. So basically it is a heterogenous key/value map. Bundles are used in Intents, Activities and Fragments for transporting data. I would like to describe how I work with Bundles on Android and show you some …">
    <meta name="twitter:url" content="http://blog.petrnohejl.cz/handling-bundles-in-activities-and-fragments">

    <!-- Feed -->
    <link rel="alternate" type="application/atom+xml" href="http://blog.petrnohejl.cz/feed.xml" title="Jestřáblog Atom Feed" />
    <link rel="alternate" type="application/rss+xml" href="http://petrnohejl.disqus.com/latest.rss" title="Jestřáblog Comments RSS Feed">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:regular,bold">
    <link rel="stylesheet" type="text/css" href="http://blog.petrnohejl.cz/theme/css/w3.css">
    <link rel="stylesheet" type="text/css" href="http://blog.petrnohejl.cz/theme/css/style.css">
    <link rel="stylesheet" type="text/css" href="http://blog.petrnohejl.cz/theme/css/jqcloud.css">
    <link rel="stylesheet" type="text/css" href="http://blog.petrnohejl.cz/theme/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="http://blog.petrnohejl.cz/theme/css/pygments-highlight-github.css">
    <link rel="stylesheet" type="text/css" href="http://blog.petrnohejl.cz/static/custom.css">

    <!-- Icon -->
    <link rel="shortcut icon" type="image/x-icon" href="http://blog.petrnohejl.cz/favicon.ico">

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="http://blog.petrnohejl.cz/theme/js/jqcloud.min.js"></script>
  </head>

  <body>
    <div class="w3-row w3-card w3-white">
      <header id="header">
        <a href="http://blog.petrnohejl.cz" id="header-logo" title="Home">PN</a>
        <nav id="header-menu">
          <ul>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="/categories.html">Categories</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="/archive.html">Archive</a></li>
          </ul>
        </nav>
      </header>
    </div>



    <br><br><br>

    <article>
      <header class="w3-container col-main">
        <h1>Handling bundles in activities and fragments</h1>
        <div class="post-info">
          <div class="w3-opacity w3-margin-right w3-margin-bottom" style="flex-grow: 1;">
            <span><time datetime="2014-03-30T00:00:00+01:00">30.03.2014</time> in <a href="http://blog.petrnohejl.cz/category/android" title="All articles in category Android">Android</a></span>
          </div>
        </div>
      </header>

      <br>


      <div class="col-main w3-container">
        <section id="content">
          <p><a href="http://developer.android.com/reference/android/os/Bundle.html">Bundle</a> is a useful data holder, which maps String values to various <a href="http://developer.android.com/reference/android/os/Parcelable.html">Parcelable</a> types. So basically it is a heterogenous key/value map. Bundles are used in <a href="http://developer.android.com/reference/android/content/Intent.html">Intents</a>, <a href="http://developer.android.com/reference/android/app/Activity.html">Activities</a> and <a href="http://developer.android.com/reference/android/app/Fragment.html">Fragments</a> for transporting data. I would like to describe how I work with Bundles on Android and show you some good tips.</p>
<h2 id="activity">Activity</h2>
<p>When you are creating a new instance of Activity via Intent, you can pass some extra data to the Activity. Data are stored in Bundle and can be retrieved by calling <code>getIntent().getExtras()</code>. It's a good practise to implement static method <code>newIntent()</code> which returns a new Intent that can be used to start the Activity. This way you have compile time checking for the arguments passed to the Activity. This pattern is suitable for Service and Broadcast as well.</p>
<p>Bundle is also used if the Activity is being re-initialized (e.g. because of configuration changes) for keeping the current state of the instance. You can supply some data in <code>onSaveInstanceState(Bundle)</code> and retrieve them back in <code>onCreate(Bundle)</code> method or <code>onRestoreInstanceState(Bundle)</code>. Main difference between these methods is that <code>onRestoreInstanceState(Bundle)</code> is called after <code>onStart()</code>. Sometimes it's convenient to restore data here after all of the initialization has been done. Another purpose could be allowing subclasses to decide whether to use your default implementation.</p>
<p>See example code below. Note that <code>EXTRA_PRODUCT_ID</code> constant is public. That's because we could need it in a Fragment encapsulated in this Activity.</p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExampleActivity</span> <span class="kd">extends</span> <span class="n">Activity</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">EXTRA_PRODUCT_ID</span> <span class="o">=</span> <span class="s">&quot;product_id&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">EXTRA_PRODUCT_TITLE</span> <span class="o">=</span> <span class="s">&quot;product_title&quot;</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SAVED_PAGER_POSITION</span> <span class="o">=</span> <span class="s">&quot;pager_position&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Intent</span> <span class="nf">newIntent</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">String</span> <span class="n">productId</span><span class="o">,</span> <span class="n">String</span> <span class="n">productTitle</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">ExampleActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="c1">// extras</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">EXTRA_PRODUCT_ID</span><span class="o">,</span> <span class="n">productId</span><span class="o">);</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">EXTRA_PRODUCT_TITLE</span><span class="o">,</span> <span class="n">productTitle</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">intent</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_example</span><span class="o">);</span>

        <span class="c1">// restore saved state</span>
        <span class="k">if</span><span class="o">(</span><span class="n">savedInstanceState</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleSavedInstanceState</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// handle intent extras</span>
        <span class="n">Bundle</span> <span class="n">extras</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getExtras</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span><span class="n">extras</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleExtras</span><span class="o">(</span><span class="n">extras</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSaveInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">outState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// save current instance state</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onSaveInstanceState</span><span class="o">(</span><span class="n">outState</span><span class="o">);</span>

        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onRestoreInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// restore saved state</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onRestoreInstanceState</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="k">if</span><span class="o">(</span><span class="n">savedInstanceState</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="c1">// TODO</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleSavedInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleExtras</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">extras</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h2 id="fragment">Fragment</h2>
<p>When you are creating a new instance of Fragment, you can pass arguments through <code>setArguments(Bundle)</code> method. Data can be retrieved with <code>getArguments()</code> method. It would be a mistake to supply initialization data through an overloaded constructor. Fragment instance can be re-created (e.g. because of configuration changes) so you would lose data, because constructor with extra parameters is not called when re-initializing Fragment. Only empty constructor is called. Best way to solve this problem is implementing static creator method <code>newInstance()</code> which returns a new instance of Fragment and sets the arguments via <code>setArguments(Bundle)</code>.</p>
<p>Fragment state can be saved using <code>onSaveInstanceState(Bundle)</code> method. It is similar to the Activity. Data can be restored in <code>onCreate(Bundle)</code>, <code>onCreateView(LayoutInflater, ViewGroup, Bundle)</code>, <code>onActivityCreated(Bundle)</code> or <code>onViewStateRestored(Bundle)</code> methods.</p>
<p>Fragment has also access to the Intent extras which were passed during creating the Activity instance. You can get this extra data by calling <code>getActivity().getIntent().getExtras()</code>.</p>
<p>See example code below.</p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExampleFragment</span> <span class="kd">extends</span> <span class="n">Fragment</span>
<span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">ARGUMENT_PRODUCT_ID</span> <span class="o">=</span> <span class="s">&quot;product_id&quot;</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SAVED_LIST_POSITION</span> <span class="o">=</span> <span class="s">&quot;list_position&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ExampleFragment</span> <span class="nf">newInstance</span><span class="o">(</span><span class="n">String</span> <span class="n">productId</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="n">ExampleFragment</span> <span class="n">fragment</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ExampleFragment</span><span class="o">();</span>

        <span class="c1">// arguments</span>
        <span class="n">Bundle</span> <span class="n">arguments</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bundle</span><span class="o">();</span>
        <span class="n">arguments</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">ARGUMENT_PRODUCT_ID</span><span class="o">,</span> <span class="n">productId</span><span class="o">);</span>
        <span class="n">fragment</span><span class="o">.</span><span class="na">setArguments</span><span class="o">(</span><span class="n">arguments</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">fragment</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">ExampleFragment</span><span class="o">()</span> <span class="o">{}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> 
    <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="c1">// handle fragment arguments</span>
        <span class="n">Bundle</span> <span class="n">arguments</span> <span class="o">=</span> <span class="n">getArguments</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span><span class="n">arguments</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleArguments</span><span class="o">(</span><span class="n">arguments</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// restore saved state</span>
        <span class="k">if</span><span class="o">(</span><span class="n">savedInstanceState</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleSavedInstanceState</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// handle intent extras</span>
        <span class="n">Bundle</span> <span class="n">extras</span> <span class="o">=</span> <span class="n">getActivity</span><span class="o">().</span><span class="na">getIntent</span><span class="o">().</span><span class="na">getExtras</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span><span class="n">extras</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleExtras</span><span class="o">(</span><span class="n">extras</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSaveInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">outState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// save current instance state</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onSaveInstanceState</span><span class="o">(</span><span class="n">outState</span><span class="o">);</span>

        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleArguments</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">arguments</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleSavedInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleExtras</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">extras</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>You can find example code also on my GitHub in <a href="https://github.com/petrnohejl/Android-Templates-And-Utilities/tree/master/Src-Bundle">Android Templates and Utilities</a> repo. This blogpost was inspired by <a href="https://plus.google.com/u/0/+AndroidDevelopers/posts/bCD7Zvd945d">Nick Butcher's post</a> on Google Plus. Gotta some questions or ideas about Bundles? Follow me on <a href="https://twitter.com/petrnohejl">Twitter</a> or <a href="https://plus.google.com/113883771155661250237">Google Plus</a>.</p>
        </section>

        <br><br><br>

        <footer>
          <div class="adjust-width">
            <div id="author-block" class="w3-light-grey w3-border">
              <div id="author-info">
                <a href="http://petrnohejl.cz"><img style="width: 60px; height: 60px;" src="http://www.gravatar.com/avatar/8fafd9d1a430a1e843478f00c3da924a?s=240" onerror="this.src='theme/images/avatar.png'" alt="Avatar"></a>
                <div style="margin-left: 20px; margin-top: 15px;">
                  <a href="http://petrnohejl.cz"><span id="author-name" class="w3-hover-text-dark-grey">Petr Nohejl</span></a>
                  <p id="author-story">Hi! I’m Petr – an Android engineer living in Brno, Czech Republic. I’m passionate about code, software architecture and technology. I studied at the Brno University of Technology and currently I work at STRV as team lead of the Android department. I’ve been developing mobile apps since 2009. I like #android #coffee #reggae #photography #djembe #asianculture #valueinvesting #myfamily.</p>
                </div>
              </div>
            </div>
          </div>

          <br><br><br>

          <p style="font-size:10pt; font-style: italic;">Did you like this article? Share it with your friends!</p>
          <div id="share" class="share">
            <a href="http://www.facebook.com/sharer.php?u=http%3A//blog.petrnohejl.cz/handling-bundles-in-activities-and-fragments&amp;t=Jest%C5%99%C3%A1blog%3A%20Handling%20bundles%20in%20activities%20and%20fragments" target="_blank" class="w3-btn w3-indigo">
              <i class="fa fa-facebook"></i> <span>Facebook</span>
            </a>
            <a href="http://twitter.com/share?url=http%3A//blog.petrnohejl.cz/handling-bundles-in-activities-and-fragments&amp;text=Jest%C5%99%C3%A1blog%3A%20Handling%20bundles%20in%20activities%20and%20fragments" target="_blank" class="w3-btn w3-blue">
              <i class="fa fa-twitter"></i> <span>Twitter</span>
            </a>
            <a href="https://plus.google.com/share?url=http%3A//blog.petrnohejl.cz/handling-bundles-in-activities-and-fragments" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" class="w3-btn w3-red">
              <i class="fa fa-google-plus"></i> <span>Google</span>
            </a>
          </div>

          <br><br><br>


          <div id="disqus_thread"></div>
          <script>
            /**
             *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
             */
            
            var disqus_config = function () {
              this.page.url = 'http://blog.petrnohejl.cz';  // Replace PAGE_URL with your page's canonical URL variable
              this.page.identifier = 'handling-bundles-in-activities-and-fragments'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            
            (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
              var d = document, s = d.createElement('script');
              
              s.src = 'https://petrnohejl.disqus.com/embed.js';  // IMPORTANT: Replace EXAMPLE with your forum shortname!
              
              s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
            })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
          <br><br><br>

        </footer>
      </div>
    </article>


    <footer id="footer">
      <div id="footer-copyright" class="w3-center w3-small w3-text-grey w3-padding-48">
        <span>
          &copy;
          2009&dash;2018          Petr Nohejl
 | <a href="http://blog.petrnohejl.cz/feed.xml">Atom feed <i class="fa fa-rss" aria-hidden="true"></i></a>        </span>
      </div>
    </footer>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-17930136-2', 'auto');
      ga('send', 'pageview');
    </script>

  </body>
</html>